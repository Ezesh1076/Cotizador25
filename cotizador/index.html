<!--<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Visualización de Excel</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <h1>Mi Excel en la Web App</h1> -->
  <!-- Código de incrustación obtenido desde OneDrive -->
  <!--<iframe src="TU_URL_DE_INCRUSTACION_AQUI" width="100%" height="600px" frameborder="0"></iframe>-->
  <!--<iframe width="100%" height="750px" frameborder="0" scrolling="no" src="https://1drv.ms/x/c/f9f8404fbd1199a8/IQSomRG9T0D4IID51QAAAAAAAWL9tWKARQkeV8syLlwtC0A?em=2&wdAllowInteractivity=False&AllowTyping=True&wdHideGridlines=True&wdHideHeaders=True&wdDownloadButton=True&wdInConfigurator=True&wdInConfigurator=True"></iframe>-->
  <!--<iframe width="100%" height="750px" frameborder="0" scrolling="no" src="https://1drv.ms/x/c/f9f8404fbd1199a8/IQSomRG9T0D4IID51QAAAAAAAWL9tWKARQkeV8syLlwtC0A?em=2&wdAllowInteractivity=False&AllowTyping=True&wdHideGridlines=True&wdHideHeaders=True&wdDownloadButton=True&wdInConfigurator=True&wdInConfigurator=True"></iframe>
  <script src="app.js"></script>
</body>
</html>-->
<!-- <!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Visualización y Exportación de Excel</title>
  <link rel="stylesheet" href="styles.css">
  <!-- Incluir las librerías: SheetJS, jsPDF y jsPDF-AutoTable -->
  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js"></script>
</head>
<body>
  <h1>Mi Excel en la Web App</h1> --> -->
  
  <!-- Incrustación de Excel desde OneDrive -->
  <!-- <iframe width="100%" height="650" frameborder="0" scrolling="no" src="https://1drv.ms/x/c/f9f8404fbd1199a8/IQSomRG9T0D4IID51QAAAAAAAUq1IWjdq00eP8nC3SbidAY?em=2&wdAllowInteractivity=False&AllowTyping=True&ActiveCell='INICIO'!A1&wdHideGridlines=True&wdHideHeaders=True&wdDownloadButton=True&wdInConfigurator=True&wdInConfigurator=True"></iframe> -->
  <!-- Contenedor para mostrar la tabla HTML extraída de la hoja específica -->
  <!-- <div id="table-container"></div> -->
  
  <!-- Botón para generar y descargar el PDF -->
  <button id="downloadPdf">Descargar PDF</button>
  
  <!-- <script>
    // URL del Excel en la nube (utiliza el mismo enlace que en el iframe o uno que permita descarga directa)
    const excelUrl ="https://1drv.ms/x/c/f9f8404fbd1199a8/IQSomRG9T0D4IID51QAAAAAAAUq1IWjdq00eP8nC3SbidAY?em=2&wd";
    
    // Cargar el archivo Excel desde la nube
  fetch(excelUrl)
  .then(response => {
    if (!response.ok) {
      throw new Error('Error en la respuesta: ' + response.statusText);
    }
    console.log("Respuesta recibida:", response);
    return response.arrayBuffer();
  })
  .then(data => {
    console.log("Tamaño del archivo descargado:", data.byteLength);
    const workbook = XLSX.read(new Uint8Array(data), { type: 'array' });

    console.log("Hojas disponibles:", workbook.SheetNames);
    const sheetName = "LP_Lamina"; // Asegúrate de que este nombre sea correcto

    if (!workbook.Sheets[sheetName]) {
      alert("La hoja '" + sheetName + "' no existe en el archivo.");
      return;
    }

    const worksheet = workbook.Sheets[sheetName];
    const htmlString = XLSX.utils.sheet_to_html(worksheet);
    document.getElementById('table-container').innerHTML = htmlString;
  })
  .catch(error => {
    console.error('Error al cargar el archivo Excel:', error);
  });

      
    // Generar el PDF a partir de la tabla HTML
    document.getElementById('downloadPdf').addEventListener('click', function() {
      const table = document.querySelector('#table-container table');
      if (!table) {
        alert("No se encontró la tabla generada. Verifica que el archivo se haya cargado correctamente y que el nombre de la hoja sea correcto.");
        return;
      }
      
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      
      // Convierte la tabla HTML a PDF
      doc.autoTable({ html: table });
      
      // Descarga el PDF
      doc.save('hoja_especifica.pdf');
    });
  </script>
</body>
</html> -->

